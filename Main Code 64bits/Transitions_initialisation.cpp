/*

Lecture de
Facteurs de Franck-Condon
Energies des niveaux de vibration (la rotation est ensuite calculée par le Bv)
Calculs de facteurs angulaires liés à la rotation


Il y a FC_abs pour l'absorption et FC_em pour l'emission

On utilise de façon générique le nom
X pour l'état fond
A pour l'état excité
donc vX, vA pour les niveaux vibrationnels et
JX, JA pour la rotation




Il y a donc des tableaux
FC_abs[vA][vX]  // Qui contient un Franck Condon pour l'absorption (Normalisés à 1 pour avoir le bon taux de transition)
proba_abs[JA][MJA][JX][MJX] et proba_em[[JA][MJA][JX][MJX] // Qui contient les facteurs genre Hönl London (Normalisés à 1 pour avoir le bon taux de transition)
// En fait pour eviter des indices <0 on note [JA][MJA+JA][JX][MJX+JX]

FC_em[vA][vX] // Qui contient un Franck Condon pondéré par un terme en (omega/omega_moyen)^3 pour tenir compte de la durée de vie

EvX[vX][JX] // Energie des états vX, JX, Pour l'instant très simple avec Bv seul
EvA[vA][JA] // Energie des états vA, JA


Les bordures sont absorbantes
i.e. les états  de vmax ou Jmax ont des Franck Condon de zéro et restent ainsi piégés


LES UNITES ICI SONT CELLES DES FICHIERS (cm^-1 typiquement)

ATTENTION
La notation  [NA][NX] indique qu'il y a
NA lignes et NX colonnes dans les tableaux
Il faut donc bien vérifier que dans les fichiers
vA indice les lignes et vX indice les colonnes

En effet les boucles sont vA puis vX


*/

#include "Transitions_initialisation.h"



// Initialise the Energy, Zeeman and dipoles matrices
void Read_Energy_Zeeman_dipole_for_Diagonalization(MatrixXcd &E0_cm, MatrixXcd &Zeeman_cm_B, MatrixXd d0[])
{


<<<<<<< HEAD
    const int nb_levels=32; //   Level.size();



    E0_cm.resize(nb_levels,nb_levels);
    Zeeman_cm_B.resize(nb_levels,nb_levels);
    d0[0].resize(nb_levels,nb_levels);
    d0[1].resize(nb_levels,nb_levels);
    d0[2].resize(nb_levels,nb_levels);



    /******* ORDER OF LEVELS (the n=0 and n=1 manifold, the one for spontaneous emission, should be order in Energy) ****************

    The annihilation is treated like a spontaneous emission down to a dead level. BEcause we have states with |m|=0,1,2 we have created 3 dead levels
    with |m|=0,1 name dead_-1 dead_0 dead_1. We have create (abritrary) a pi spontaneous emission with all m=-1,0,1 and only the 3P2-2   and 3P22 are simga+ and sigma-

    For convenience we have ordered the level in energy such that the Zeeman effect keep this ordering (for very small field)
    And for degenerate levels that stay degenerate even with Zeeman effect we have added a small shift to ensure the energy ordering

    *************************************/


    double E0[nb_levels][nb_levels] = // With 1e-5 offset
    {
        {-10000., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., -9999.99999999, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., -9999.99999998, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., -9999.99999997, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., -9999.99999996, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., -6.81758991, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 6.e-8, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 8.e-8, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 2.e-7, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 41147.8143057, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.05779095, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.24039899, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.24039901, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.24040618, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.30127183, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.30127951, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.30127953, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.38649741, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.38649745, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.38650254, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.38650256, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.38650426, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.66650546, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.66650548, 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.6665065, 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318617, 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318618, 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318619, 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.5531862, 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318621, 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318622, 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318623}
    };



    /** For the Zeeman effect in cm^-1  ****/

    // <i|H(Zeeman)|j> in cm-1 for B=1T  i = line, j = column
    double Zeeman[nb_levels][nb_levels] =
    {
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0.9348136, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0.9348136, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.9348136, 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.53971488, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.53971488, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.76327211, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.66101304, 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.76327211, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.9348136, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
        {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}
    };


    /***  <i|d_q|j> in Debye is coded here as d[q+1][i][j] (real), i = line, j = column ; that is for a i<-->j transition (with E_i> E_j) ****/

    double dipole[3][nb_levels][nb_levels]=
    {
        {   {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -2.18635415, 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., -1.54598585, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 2.18635415, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 8.80487252, 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 3.78687648, 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 1.54598585, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 6.22598507, 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -8.80487252, 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., -6.22598507, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.66936111, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.44570913, 0., 0., 0., 1.66936111, 0., 0., 0., 1.44570913, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 2.28589077, 1.28256281, 0., 0., 1.33069884, 1.18041656, 0., 0., 0., 0., 0., 0., 1.2325483, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.03637241, 0., 0., 0., 0.86876481, 0., 0., 0., 1.03637241, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.86876481, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}
        },
        {   {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 159.77791603, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 4.73802941, 0., 0., 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 4.73802941, 0., 0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 4.73802941, 0., 0., 0., 0., 0., 0., 0., -2.18635415, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 3.09197169, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 4.8785062, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0.01545615, 0., 0., 0., 0., 0., -2.18635415, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -8.80487252, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0.00256187, 0., 0., 3.78687648, 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0.00256187, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0.00256187, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0.00798145, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0.00798145, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0.00798145, 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0.00798145, 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0.00798145, 0., 0., 0., 0., 0., 3.09197169, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 12.45197014, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0.14481091, 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0.14481091, 0., 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0.14481091, 0., 0., 0., 0., 0., 0., 0., -8.80487252, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 12.45197014, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.18041656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.33069884, 0., 0., 0., 1.18041656, 0., 0., 0., 1.33069884, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 2.28589077, 1.28256281, 0., 0., 1.18041656, 1.46565192, 0., 0., 0., 0., 0., 0., 1.37715339, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.33069884, 0., 0., 0., 1.18041656, 0., 0., 0., 1.33069884, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.18041656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}
        }
        ,
        {
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -2.18635415, 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., -1.54598585, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 2.18635415, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 8.80487252, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 3.78687648, 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 1.54598585, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 6.22598507, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -8.80487252, 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., -6.22598507, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.86876481, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.03637241, 0., 0., 0., 0.86876481, 0., 0., 0., 1.03637241, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 2.28589077, 1.28256281, 0., 0., 1.33069884, 1.18041656, 0., 0., 0., 0., 0., 0., 1.2325483, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.44570913, 0., 0., 0., 1.66936111, 0., 0., 0., 1.44570913, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.66936111, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}
        }
    };
=======
        const int nb_levels=32; //   Level.size();

        /******* ORDER OF LEVELS (the n=0 and n=1 manifold, the one for spontaneous emission, should be order in Energy) ****************

        The annihilation is treated like a spontaneous emission down to a dead level. BEcause we have states with |m|=0,1,2 we have created 3 dead levels
        with |m|=0,1 name dead_-1 dead_0 dead_1. We have create (abritrary) a pi spontaneous emission with all m=-1,0,1 and only the 3P2-2   and 3P22 are simga+ and sigma-

        For convenience we have ordered the level in energy such that the Zeeman effect keep this ordering (for very small field)
        And for degenerate levels that stay degenerate even with Zeeman effect we have added a small shift to ensure the energy ordering

        *************************************/


        double E0[nb_levels][nb_levels] = // With 1e-5 offset
        {
            {-10000., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., -9999.99999999, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., -9999.99999998, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., -9999.99999997, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., -9999.99999996, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., -6.81758991, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 6.e-8, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 8.e-8, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 2.e-7, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 41147.8143057, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.05779095, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.24039899, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.24039901, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.24040618, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.30127183, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.30127951, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.30127953, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.38649741, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.38649745, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.38650254, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.38650256, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.38650426, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.66650546, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.66650548, 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41148.6665065, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318617, 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318618, 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318619, 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.5531862, 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318621, 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318622, 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 54865.55318623}
        };



        /** For the Zeeman effect in cm^-1  ****/

        // <i|H(Zeeman)|j> in cm-1 for B=1T  i = line, j = column
        double Zeeman[nb_levels][nb_levels] =
        {
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0.9348136, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0.9348136, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.9348136, 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.53971488, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.53971488, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.76327211, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -0.66101304, 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.66101304, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.76327211, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0.9348136, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
            {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}
        };


        /***  <i|d_q|j> in Debye is coded here as d[q+1][i][j] (real), i = line, j = column ; that is for a i<-->j transition (with E_i> E_j) ****/

        double dipole[3][nb_levels][nb_levels]=
        {
            {   {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -2.18635415, 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., -1.54598585, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 2.18635415, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 8.80487252, 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 3.78687648, 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 1.54598585, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 6.22598507, 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -8.80487252, 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., -6.22598507, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.66936111, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.44570913, 0., 0., 0., 1.66936111, 0., 0., 0., 1.44570913, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 2.28589077, 1.28256281, 0., 0., 1.33069884, 1.18041656, 0., 0., 0., 0., 0., 0., 1.2325483, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.03637241, 0., 0., 0., 0.86876481, 0., 0., 0., 1.03637241, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.86876481, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}
            },
            {   {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 159.77791603, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 4.73802941, 0., 0., 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 4.73802941, 0., 0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 4.73802941, 0., 0., 0., 0., 0., 0., 0., -2.18635415, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 3.09197169, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 4.8785062, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0.01545615, 0., 0., 0., 0., 0., -2.18635415, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -8.80487252, 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0.00256187, 0., 0., 3.78687648, 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0.00256187, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0.00256187, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0.00798145, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0.00798145, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0.00798145, 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0.00798145, 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0.00798145, 0., 0., 0., 0., 0., 3.09197169, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 12.45197014, 0., 0., 0., 0., 0., 0., 0.},
                {0., 0.14481091, 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0.14481091, 0., 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0.14481091, 0., 0., 0., 0., 0., 0., 0., -8.80487252, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 12.45197014, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.18041656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.33069884, 0., 0., 0., 1.18041656, 0., 0., 0., 1.33069884, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 2.28589077, 1.28256281, 0., 0., 1.18041656, 1.46565192, 0., 0., 0., 0., 0., 0., 1.37715339, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.33069884, 0., 0., 0., 1.18041656, 0., 0., 0., 1.33069884, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.18041656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}
            }
            ,
            {
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -2.18635415, 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., -1.54598585, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., -2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 2.18635415, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 8.80487252, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 3.78687648, 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 3.78687648, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 15.25048656, 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 2.67772604, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 1.54598585, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 6.22598507, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -15.25048656, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., -8.80487252, 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., -6.22598507, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.78372246, 0., 0., 0., 0., 0., 0., 0., -10.78372246, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.86876481, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.03637241, 0., 0., 0., 0.86876481, 0., 0., 0., 1.03637241, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 2.28589077, 1.28256281, 0., 0., 1.33069884, 1.18041656, 0., 0., 0., 0., 0., 0., 1.2325483, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.44570913, 0., 0., 0., 1.66936111, 0., 0., 0., 1.44570913, 0., 0., 2.28589077, 0., 0., 0., 0., 0., 0., 0., 0.},
                {0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.66936111, 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}
            }
        };
>>>>>>> f1d67ca6be17196db0b5ab5615163dc80d1182e6

// For small sizes, especially for sizes smaller than (roughly) 16, using fixed sizes is hugely beneficial to performance, as it allows Eigen to avoid dynamic
// So here I use fixed size
// Furthermore it seems that using dynamical and MatrixXcd (not with MatrixXd for H) create a memory problem!!



    /*** Energy and Zeeman matrix element ***/
<<<<<<< HEAD
    for (int i=0; i<nb_levels; i++)
        for (int j=0; j<nb_levels; j++)
        {
            E0_cm(i,j)= E0[i][j];
            Zeeman_cm_B(i,j)= Zeeman[i][j];
        }


    /*** dipole matrix element ***/

    for (int i=0; i<nb_levels; i++)
        for (int j=0; j<nb_levels; j++)
        {
            for(int n_polar = -1; n_polar <= 1; n_polar++)
            {
                d0[n_polar+1](i,j)= dipole[n_polar+1][i][j]; // d0[q+1]_ij = 0_<i | d_q | j>_0   (i = out and j = in)
                // cout << "polar " << n_polar << " i  "  << i  << " j " << j  << " d " <<  d0[n_polar+1](i,j) << endl;
            }
        }
=======
        for (int i=0; i<nb_levels; i++)
            for (int j=0; j<nb_levels; j++)
            {
                    E0_cm(i,j)= E0[i][j];
                    Zeeman_cm_B(i,j)= Zeeman[i][j];
            }


      /*** dipole matrix element ***/

        for (int i=0; i<nb_levels; i++)
            for (int j=0; j<nb_levels; j++)
            {
                for(int n_polar = -1; n_polar <= 1; n_polar++)
                {
                    d0[n_polar+1](i,j)= dipole[n_polar+1][i][j]; // d0[q+1]_ij = 0_<i | d_q | j>_0   (i = out and j = in)
                    // cout << "polar " << n_polar << " i  "  << i  << " j " << j  << " d " <<  d0[n_polar+1](i,j) << endl;
                }
            }
>>>>>>> f1d67ca6be17196db0b5ab5615163dc80d1182e6

}







/** ENERGY LIST **/
//  Gives
// Molecule Manifold   M  Sym  #  g Population Label  Energy Linear   Dipole  Err  Quadratic       Err  Two_Level Energy Delta     C              Dipole2    Err
// WE DO NOT USE IT LIKE THAT BUT USING ORIGIN WE MODIFY AND USE ONLY
// Manifold(1 for upper or 0 for lower typically)  M(in Field it is real M)  bound_level  #(number to discriminate the levels) Population J N  Energy0(in 0 field)   Delta   C
// Where for fit in Energy in Fields  Energy +/- Sqrt(Delta^2/4 + C^2*F^2) where F is field
// C= Linear coefficient is in cm-1/T
// Energy and Delta are in cm-1

/*** Program to read Line or Energy list ***/
//  Gives
// Molecule Manifold   M  Sym  #  g Population Label  Energy Linear   Dipole  Err  Quadratic       Err  Two_Level Energy Delta     C              Dipole2    Err
// WE DO NOT USE IT LIKE THAT BUT USING ORIGIN WE MODIFY AND USE ONLY
// Manifold(1 for upper or 0 for lower typically)  M(in Field it is real M)  bound_level  #(number to discriminate the levels)   Energy0(in 0 field)   Delta   C
// Where for fit in Energy in Fields  Energy +/- Sqrt(Delta^2/4 + C^2*F^2) where F is field
// C= Linear coefficient is in cm-1/T
// Energy and Delta are in cm-1

// Retourne le nb de niveaux (1 si contient seulement Level[0])
int Level_List(const char *nom_file, vector <Internal_state> &Level, FitParams &params)
{
    Level.clear();
    ifstream file(nom_file);
    if ( !file )
    {
        cerr << "Erreur d'ouverture fichier Level"  << nom_file << endl;
        return 0;
    }

    int i=0; // Compteur du nombre de niveaux

    int type_of_field_for_internal_state_shift = params.LocateParam("type_of_field_for_internal_state_shift")->val;

    while (!file.eof())
    {
        Internal_state Current_Level;
        if (type_of_field_for_internal_state_shift == 0) // Zeeman effect
            Current_Level.read_Level__B(file); // read the new level
        if (type_of_field_for_internal_state_shift == 10) // Stark effect
            Current_Level.read_Level__E(file); // read the new level
        Level.push_back(Current_Level);
        i++;
        // cout << i << "  "  << Level[i].Energy0_cm << "  " << Level[i].Delta_FieldB << endl;
    }
    file.close();
    return i;
}

/*** LINE LIST *****/
// Read the file containing the position, assignment and intensity of lines in the simulated spectrum.
// Retourne le nb de transitions
//  C'est une liste qui depuis l'état de départ pointe vers tous les états d'arrivés possible
int Line_List(const char *nom_file, vector <Internal_state> &Level, FitParams &params)
{
    int nb_levels = Level.size();

    ifstream file(nom_file);

    if ( !file )
    {
        cerr << "Erreur d'ouverture fichier Lignes" << nom_file << endl;
        return 0;
    }

    Internal_state Up_state, Low_state;
    double dip_Debye;

    int i=0; // Compteur du nombre de transitions

    while (!file.eof())
    {
        read_Line(file, Up_state, Low_state, dip_Debye); // Transition Up_state --> Low_state avec dipole dip_Debye
// On ajoute ensuite à la liste des raies le vrai niveau car il contient plus d'informations (en particulier les variations en champ E et B)
// que celui donné dans le fichier de liste des raies
        int n_up = -1;
        int n_low = -1;
        for (int j = 0; j < nb_levels; j++) // Boucle pour voir dans la liste des niveaux où sont Up_state et Low_state
        {
            if (Level[j].is_equal (Up_state))
                n_up=j;
            if (Level[j].is_equal (Low_state))
                n_low=j;

        }

        // cout << " Transition entre niveau num. " << n_up << " et " << n_low << endl;
        if ((n_up != -1) && (n_low != -1)) // if we have find the corresponding levels then add the transition
        {
            Level[n_up].add_transition ( &(Level[n_low]), dip_Debye); // Ajoute la transition  Up_state --> Low_state avec dipole dip_Debye
            Level[n_low].add_transition ( &(Level[n_up]), dip_Debye);
            i++;
        }
    }
    file.close();
    return i;

}



/************************************************************************/
/************************** INITIALISATION FC, Energie, HL **************/
/************************************************************************/

// Initialisation des durées de vies
void initialisation_Gamma( vector <Internal_state> &Level, FitParams &params)
{
    int nb_Levels = Level.size();
    for (int i = 0; i < nb_Levels; i++) // Boucle pour voir dans la liste des niveaux où sont Up_state et Low_state
        Level[i].one_over_lifetime =  Level[i].Einstein_desex_rate();
}



// Initialisation des probabilités de peuplement de départ
void initialisation_proba(const gsl_rng *r, vector <Molecule> &Mol, const int Nb_molecules, const vector <Internal_state> &Level)
{

    int nb_Levels = Level.size();

    double *proba = new double[nb_Levels]; // We can not use   vector <double> proba because of gsl_ran_discrete_preproc

    for (int i=0; i<nb_Levels; i++)
        proba[i]=Level[i].population;


    gsl_ran_discrete_t * g = gsl_ran_discrete_preproc(nb_Levels, proba); // crée un générateur de nombre aléatoire selon les poids donné par le tableau proba[]

    for (int nb = 0; nb < Nb_molecules; nb ++)
    {
        int numero = gsl_ran_discrete(r, g); // Numéro du niveau tiré au Hazard
        Mol[nb] = Level[numero]; // The vector Mol has been created before so no push_pack() it is a modification of the content !. c'est l'état interne de la molecule

<<<<<<< HEAD
  Mol[nb] = Level[nb];
// DEBUG
//  cerr << "ATTENTION A ENLEVER dans initialisation_proba test pour Ps " << endl;
=======
 //     Mol[nb] = Level[nb];
// DEBUG
 // cerr << "ATTENTION A ENLEVER dans initialisation_proba test pour Ps " << endl;
>>>>>>> f1d67ca6be17196db0b5ab5615163dc80d1182e6
    }
    gsl_ran_discrete_free (g);

    delete[] proba;
    return;
}

